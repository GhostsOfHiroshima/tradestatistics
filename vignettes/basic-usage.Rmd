---
title: "How to use this package"
author: "Mauricio Vargas S."
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{How to use this package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

The [Observatory of Economic Complexity](https://atlas.media.mit.edu/en/) is the world's leading visualization engine for international trade data. `oec` provides an easy way to obtain data from the OEC by accessing its API.

Using the oec R package is all about efficiency, without this package you could obtain the same data from the API at the expense of using additional time and effort for the same results. As an API wrapper and utility program this package makes data obtaining faster and easier for you.

This is what the package does:

![](http://pacha.hk/oec/data-diagram.svg)

# Package data

## Country codes

If you don't know a certain country code you can explore this data before using the functions.

```{r countries, eval = TRUE}
library(tradestatistics)

countries
```

## Product codes

Open Trade Statistics (aka OTS) takes data classified using either HS92, HS96, HS02 and HS07 (Harmonized System) or SITC rev. 1 and rev. 2 (Standard International Trade Classification). A part of our project is to combine all of this under HS07 codes, and to make it available for the period 1962-2016 even for the years before 2007 when HS07 was not even created nor in use.

As [UN Comtrade](https://comtrade.un.org/db/mr/rfglossarylist.aspx) explains both HS and SITC are trade classifications that are updated by releasing new revisions, and when a classification is released then it remains unaltered. For example, HS92 was released in 1992 and its product codes remain unaltered until today, while newer classifications (e.g. HS07) were created to include newer products (e.g. it was important to provide more details about electronic products that did not exist when HS92 was created).

Each of these classifications consists in numeric codes and a detailed product name associated to each code, for example HS92 (and all HS revisions) contain 4 and 6 digits long codes while SITC does only contain 4 digits long codes in our cleaned datasets (there are 5 digits long SITC codes that we are not using):

```{r products, eval = TRUE}
products
```

Each product belongs to a group with a given name and number according to HS classification.

# Package functions

## country_code

The end user can use this function to find an ISO code by providing a country name. This works by implementing partial search.

Basic examples:
```{r country_code}
# Single match with no replacement
country_code("Chile")

# Single match with replacement
country_code("America")

# Double match with no replacement
country_code("Germany")
```

## product_code

The end user can use this function to find a commodity code by providing a product name. This works by implementing partial search.

```{r product_code}
product_code("wine")
```

## trade_data

This function downloads data for a single year and needs (at least) some filter parameters according to the query type.
 
### Bilateral trade at commodity level (Year - Reporter - Partner - Commodity)

If we want Chile-Argentina bilateral trade at commodity level in 1980:
```{r trade_data_1, eval = TRUE}
# What does Chile exchange with Argentina? (1980)
trade_data(years = 1980, reporter = "chl", partner = "arg")
```
Which is the same as:
```{r trade_data_1_var, eval = FALSE}
trade_data(years = 1980, reporter = "chl", partner = "arg", table = "yrpc")
```

If we want Chile-Argentina bilateral trade at commodity level in 1980-1985:
```{r trade_data_2, eval = FALSE}
# What does Chile exchange with Argentina? (1980-1985)
trade_data(years = 1980:1985, reporter = "chl", partner = "arg")
```

If we want Chile-Argentina bilateral trade at commodity level in 1980, 1995 and 2007:
```{r trade_data_3, eval = FALSE}
# What does Chile exchange with Argentina? (1980-1985)
trade_data(years = c(1980,1995,2007), reporter = "chl", partner = "arg")
```

Here some fields deserve an explanation:

* `commodity_code`: HS07 product codes (e.g. according to the \code{products} table within this package, 0101 stands for "Horses, etc.")
* `commodity_code_length`: How many digits does `commodity_code` contain, this can be useful to filter by depth when using HS codes (HS 6 digits is a more detailed version of HS 4 digits, and therefore you don't have to sum both or you'll be counting exports/imports twice)
* `group_code`: International categorization of group products defined after product ID
* `group_name`: English name corresponding to `group_id`
* `export_value_usd`: Exports measured in nominal United States Dollars (USD)
* `import_value_usd`: Imports measured in nominal United States Dollars (USD)
* `export_value_usd_percentage_change_1_year`: Nominal increase/decrease in exports measured as percentage with respect to last year
* `export_value_usd_percentage_change_5_years`: Nominal increase/decrease in exports measured as percentage with respect to five years ago
* `export_value_usd_change_1_year`: Nominal increase/decrease in exports measured in USD with respect to last year
* `export_value_usd_change_5_years`: Nominal increase/decrease in exports measured in USD with respect to five years ago

### Bilateral trade at aggregated level (Year - Reporter - Partner)

If we want Chile-Argentina bilateral trade at aggregated level in 1980:
```{r trade_data_4, eval = TRUE}
# What does Chile exchange with Argentina? (1980)
trade_data(years = 1980, reporter = "chl", partner = "arg", table = "yrp")
```

### Reporter trade at commodity level (Year - Reporter - Commodity) 

If we want Chilean trade at commodity level in 1980:
```{r trade_data_5, eval = TRUE}
# What does Chile exchange? (1980)
trade_data(years = 1980, reporter = "chl", table = "yrc")
```

Here the `export_rca*` and `import_rca*` fields contain the Revealed Comparative Advantage (RCA) of an exported product with respect to all the products with the same number of digits. The definition of RCA is detailed on [Open Trade Statistics Documentation](https://tradestatistics.github.io/documentation/).

### Reporter trade at aggregated level (Year - Reporter)

If we want Chilean trade at aggregated level in 1980:
```{r trade_data_6, eval = TRUE}
# What does Chile exchange? (1980)
trade_data(years = 1980, reporter = "chl", table = "yr")
```

Here some fields deserve an explanation:

* `eci_4_digits_commodity_code`: Economic Complexity Index (ECI) which is detailed on [Open Trade Statistics Documentation](https://tradestatistics.github.io/documentation/). This index is built by using just four digits commodity codes.
* `eci_rank_4_digits_commodity_code`: The rank of a country given its ECI (e.g. the highest ECI obtains the #1)
* `eci_rank_4_digits_commodity_code_delta_1_year`: How many places a country increased or decreased with respect to last year

### Commodity trade at aggregated level (Year - Commodity)

If we want all products trade in 1980:
```{r trade_data_7, eval = TRUE}
# Which products are exchanged? (1980)
trade_data(years = 1980, table = "yc")
```

Here some fields deserve an explanation:

* `pci_4_digits_commodity_code`: Product Complexity Index (PCI) which is detailed on [Open Trade Statistics Documentation](https://tradestatistics.github.io/documentation/). This index is built by using just four digits commodity codes.
* `pci_6_digits_commodity_code`: Similar to the previous field but built by using just six digits commodity codes.
* `pci_rank_4_digits_commodity_code`: The rank of a product given its PCI (e.g. the highest PCI obtains the #1)
* `pci_rank_4_digits_commodity_code_delta_1_year`: How many places a country increased or decreased with respect to last year
